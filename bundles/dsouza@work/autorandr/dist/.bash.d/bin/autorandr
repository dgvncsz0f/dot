#!/bin/sh

autorandr_adjust () {
  (IFS=$'\n'; div=" ";
   for input in $(xrandr -q | grep -Eo '^.*? (dis)?connected\b')
   do
     head=$(echo "$input" | cut -d' ' -f1)
     state=$(echo "$input" | cut -d' ' -f2)
     case "$state" in
       (disconnected)
         echo -n "--output $head --off $div"
         ;;
       (connected)
         echo -n "--output $head --auto $div"
         ;;
     esac
     div="--left-of $head "
   done)
}

autorandr_order () {
  echo -n "--output "
  cut $AUTORANDR_ORDER -d' ' -f1
  for head in $(echo $AUTORANDR_ORDER)
  do "--left-of $head"; done
}

xrandr $(autorandr_adjust)
if [ -n "AUTORANDR_ORDER" ]
then xrandr $(autorandr_order); fi
