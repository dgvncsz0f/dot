#!/bin/sh

my_colors()
{
fg_norm_black='[22;30m'
bg_norm_black='[22;40m'
fg_bold_black='[01;30m'
bg_bold_black='[01;40m'

fg_norm_grey=$fg_norm_black
bg_norm_black=$bg_norm_black
fg_bold_grey=$fg_bold_black
bg_bold_black=$bg_bold_black

fg_norm_red='[22;31m'
bg_norm_red='[22;41m'
fg_bold_red='[01;31m'
bg_bold_red='[01;41m'

fg_norm_magenta='[22;35m'
bg_norm_magenta='[22;45m'
fg_bold_magenta='[01;35m'
bg_bold_magenta='[01;45m'

fg_norm_green='[22;32m'
bg_norm_green='[22;42m'
fg_bold_green='[01;32m'
bg_bold_green='[01;42m'

fg_norm_yellow='[22;33m'
bg_norm_yellow='[22;43m'
fg_bold_yellow='[01;33m'
bg_bold_yellow='[01;43m'

fg_norm_blue='[22;34m'
bg_norm_blue='[22;44m'
fg_bold_blue='[01;34m'
bg_bold_blue='[01;44m'

fg_norm_cyan='[22;36m'
bg_norm_cyan='[22;46m'
fg_bold_cyan='[01;36m'
bg_bold_cyan='[01;46m'

fg_norm_white='[22;37m'
bg_norm_white='[22;47m'
fg_bold_white='[01;37m'
bg_bold_white='[01;47m'

fg_norm_def='[22;39m'
bg_norm_def='[22;49m'
fg_bold_def='[01;39m'
bg_bold_def='[01;49m'

nocolors='[0m'
}

my_setenv()
{
  export VISUAL=editor
  export EDITOR=editor
  export GNUPGHOME=$HOME/sec/gnupg
  export PAGER=/usr/bin/less
  export GPG_TTY=$(/usr/bin/tty)
  export LANG=en_US.UTF-8
  export LC_ALL=en_US.UTF-8
  if [ "`id -u`" -eq 0 ]; then
    export PATH="$HOME/.dot/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
  else
    export PATH="$HOME/.dot/bin:/usr/local/bin:/usr/bin:/bin:/usr/games"
  fi
}

my_aliases()
{
  alias ll="ls -l"
  alias l1="ls -1"
  alias la="ll -a"
  alias rm="/bin/rm -i"
  alias startx="/usr/bin/startx & disown; exit"
}

my_loadrvm()
{
  if [ -f ~/.rvm/scripts/rvm ]
  then
    . ~/.rvm/scripts/rvm
  fi
}

my_encfs()
{
  local bin_encfs
  local bin_mount
  local bin_wc
  local bin_grep

  bin_encfs=/usr/bin/encfs
  bin_mount=/bin/mount
  bin_wc=/usr/bin/wc
  [ -x /bin/grep ] && bin_grep=/bin/grep
  [ -x /usr/bin/grep ] && bin_grep=/usr/bin/grep
  if [ -x "${bin_encfs}" ]
  then
    if [ -d "${HOME}/.sec" ]
    then
      while [ "`\"${bin_mount}\" | \"${bin_grep}\" "${HOME}/sec" | \"${bin_wc}\" -l`" != "1" ]
      do
        "${bin_encfs}" "${HOME}/.sec" "${HOME}/sec" -o nonempty
      done
    fi
  fi
}

my_gpgagent_export()
{
  if [ -f "$HOME/.gpg-agent.env" ]
  then
    . "$HOME/.gpg-agent.env"
    export GPG_AGENT_INFO
    export SSH_AGENT_PID
    export SSH_AUTH_SOCK
    /usr/bin/gpg-connect-agent updatestartuptty /bye >/dev/null 2>&1
  fi
}

my_gpgagent_cleanse()
{
  my_gpgagent_export

  if [ -x /usr/bin/gpg-connect-agent ]
  then
    if ! /usr/bin/gpg-connect-agent /bye 2>/dev/null
    then
      rm -f "$HOME/.gpg-agent.env"
    fi
  fi
}

my_gpgagent_init()
{
  local daemon_args

  my_gpgagent_cleanse
  if [ ! -f "$HOME/.gpg-agent.env" ]
  then
    if [ -d "$HOME/sec/gnupg" ]
    then
      /usr/bin/gpg-agent --daemon --sh --homedir "$HOME/sec/gnupg" --enable-ssh-support --write-env-file "$HOME/.gpg-agent.env" $daemon_args
    fi
  fi
}

